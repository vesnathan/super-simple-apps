# Base schema with shared types and scalars

scalar AWSDateTime
scalar AWSTimestamp

type Card @aws_iam @aws_cognito_user_pools {
  id: ID!
  question: String!
  answer: String!
  cardType: String              # 'text' or 'multiple-choice', defaults to 'text'
  options: [String!]            # 3 options for multiple choice
  correctOptionIndex: Int       # 0, 1, or 2 - index of correct option
  explanation: String           # Explanation shown after answer
  imageUrl: String              # Optional image URL displayed on the card
}

input CardInput {
  id: ID!
  question: String!
  answer: String!
  cardType: String
  options: [String!]
  correctOptionIndex: Int
  explanation: String
  imageUrl: String
}

input UpdateCardInput {
  question: String
  answer: String
  cardType: String
  options: [String!]
  correctOptionIndex: Int
  explanation: String
  imageUrl: String
}
# Deck types and operations

type Deck @aws_iam @aws_cognito_user_pools {
  id: ID!
  userId: ID!
  title: String!
  cards: [Card!]!
  cardCount: Int!
  isPublic: Boolean!
  createdAt: AWSDateTime!
  lastModified: AWSTimestamp!
}

input CreateDeckInput {
  id: ID!
  title: String!
  cards: [CardInput!]
  isPublic: Boolean
}

input SyncDeckInput {
  id: ID!
  title: String!
  cards: [CardInput!]!
  isPublic: Boolean
  createdAt: AWSDateTime
  lastModified: AWSTimestamp
}

input UpdateDeckInput {
  title: String
  isPublic: Boolean
}

type SyncResult @aws_cognito_user_pools {
  success: Boolean!
  syncedCount: Int!
}

type PublicDecksResult @aws_iam @aws_cognito_user_pools {
  decks: [Deck!]!
  nextToken: String
}

type Query {
  publicDecks: [Deck!]! @aws_iam @aws_cognito_user_pools
  searchPublicDecks(search: String, limit: Int, nextToken: String): PublicDecksResult! @aws_iam @aws_cognito_user_pools
  myDecks: [Deck!]! @aws_cognito_user_pools
  getDeck(id: ID!): Deck @aws_iam @aws_cognito_user_pools
}

type DeleteDeckResult @aws_cognito_user_pools {
  success: Boolean!
  deletedId: ID!
}

type Mutation {
  createDeck(input: CreateDeckInput!): Deck! @aws_cognito_user_pools
  syncDecks(decks: [SyncDeckInput!]!): SyncResult! @aws_cognito_user_pools
  updateCard(deckId: ID!, cardId: ID!, input: UpdateCardInput!): Deck! @aws_cognito_user_pools
  updateDeck(deckId: ID!, input: UpdateDeckInput!): Deck! @aws_cognito_user_pools
  deleteDeck(deckId: ID!): DeleteDeckResult! @aws_cognito_user_pools
}
