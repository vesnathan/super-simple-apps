# Deck types and operations

type Deck @aws_iam @aws_cognito_user_pools {
  id: ID!
  userId: ID!
  title: String!
  description: String
  tags: [String!]
  cards: [Card!]!
  cardCount: Int!
  isPublic: Boolean!
  views: Int!
  createdAt: AWSDateTime!
  lastModified: AWSTimestamp!
}

input CreateDeckInput {
  id: ID!
  title: String!
  cards: [CardInput!]
  isPublic: Boolean
}

input SyncDeckInput {
  id: ID!
  title: String!
  cards: [CardInput!]!
  isPublic: Boolean
  createdAt: AWSDateTime
  lastModified: AWSTimestamp
}

input UpdateDeckInput {
  title: String
  isPublic: Boolean
}

type SyncResult @aws_cognito_user_pools {
  success: Boolean!
  syncedCount: Int!
}

type PublicDecksResult @aws_iam @aws_cognito_user_pools {
  decks: [Deck!]!
  nextToken: String
}

type Query {
  publicDecks: [Deck!]! @aws_iam @aws_cognito_user_pools
  searchPublicDecks(search: String, limit: Int, nextToken: String): PublicDecksResult! @aws_iam @aws_cognito_user_pools
  popularDecks(limit: Int): [Deck!]! @aws_iam @aws_cognito_user_pools
  myDecks: [Deck!]! @aws_cognito_user_pools
  getDeck(id: ID!): Deck @aws_iam @aws_cognito_user_pools
  getDecksByIds(ids: [ID!]!): [Deck!]! @aws_iam @aws_cognito_user_pools
}

type DeleteDeckResult @aws_cognito_user_pools {
  success: Boolean!
  deletedId: ID!
}

type IncrementViewsResult @aws_iam @aws_cognito_user_pools {
  success: Boolean!
  views: Int!
}

input ReportCardInput {
  deckId: ID!
  cardId: ID!
  reason: String!
}

type ReportCardResult @aws_iam @aws_cognito_user_pools {
  success: Boolean!
}

type Mutation {
  createDeck(input: CreateDeckInput!): Deck! @aws_cognito_user_pools
  syncDecks(decks: [SyncDeckInput!]!): SyncResult! @aws_cognito_user_pools
  updateCard(deckId: ID!, cardId: ID!, input: UpdateCardInput!): Deck! @aws_cognito_user_pools
  updateDeck(deckId: ID!, input: UpdateDeckInput!): Deck! @aws_cognito_user_pools
  deleteDeck(deckId: ID!): DeleteDeckResult! @aws_cognito_user_pools
  incrementDeckViews(deckId: ID!): IncrementViewsResult! @aws_iam @aws_cognito_user_pools
  reportCard(input: ReportCardInput!): ReportCardResult! @aws_iam @aws_cognito_user_pools
}
